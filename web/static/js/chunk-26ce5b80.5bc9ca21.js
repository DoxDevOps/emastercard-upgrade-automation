(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26ce5b80"],{"3df9":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex",attrs:{id:"wrapper"}},[a("SideBar"),a("div",{attrs:{id:"page-content-wrapper"}},[a("TopNav"),a("div",{staticClass:"content"},[t._t("default")],2)],1)],1)},r=[],i=a("7c08"),s=a("ebd8"),c={name:"PageView",components:{SideBar:i["a"],TopNav:s["a"]}},o=c,l=(a("d1a5"),a("2877")),u=Object(l["a"])(o,n,r,!1,null,"09d8855c",null);e["a"]=u.exports},7634:function(t,e,a){"use strict";var n=a("f39c"),r=a.n(n);r.a},8519:function(t,e,a){},"92da":function(t,e,a){},a434:function(t,e,a){"use strict";var n=a("23e7"),r=a("23cb"),i=a("a691"),s=a("50c4"),c=a("7b0b"),o=a("65f0"),l=a("8418"),u=a("1dde"),d=a("ae40"),f=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!f||!p},{splice:function(t,e){var a,n,u,d,f,p,P=c(this),b=s(P.length),_=r(t,b),C=arguments.length;if(0===C?a=n=0:1===C?(a=0,n=b-_):(a=C-2,n=h(m(i(e),0),b-_)),b+a-n>g)throw TypeError(v);for(u=o(P,n),d=0;d<n;d++)f=_+d,f in P&&l(u,d,P[f]);if(u.length=n,a<n){for(d=_;d<b-n;d++)f=d+n,p=d+a,f in P?P[p]=P[f]:delete P[p];for(d=b;d>b-n+a;d--)delete P[d-1]}else if(a>n)for(d=b-n;d>_;d--)f=d+n-1,p=d+a-1,f in P?P[p]=P[f]:delete P[p];for(d=0;d<a;d++)P[d+_]=arguments[d+2];return P.length=b-n+a,u}})},c782:function(t,e,a){"use strict";var n=a("cd59"),r=a.n(n);r.a},cd59:function(t,e,a){},d1a5:function(t,e,a){"use strict";var n=a("8519"),r=a.n(n);r.a},e453:function(t,e,a){"use strict";var n=a("92da"),r=a.n(n);r.a},f39c:function(t,e,a){},f742:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("PageView",[a("div",{staticClass:"row"},t._l(t.errors,(function(e,n){return a("div",{key:n,staticClass:"alert alert-danger alert-dismissible fade show col-md-8 offset-md-2",attrs:{role:"alert"}},[t._v(" "+t._s(e)+" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-label":"Close"},on:{click:function(){return t.onDeleteError(n)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])])})),0),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-5 offset-md-1"},[a("PatientList",{attrs:{patients:t.targetPatients},on:{"on-search":t.searchTargetPatients,"on-patient-selected":t.onSelectTargetPatient}})],1),a("div",{staticClass:"col-md-5"},[a("PatientList",{attrs:{patients:t.sourcePatients},on:{"on-search":t.searchSourcePatients,"on-patient-selected":t.onSelectSourcePatient}})],1)]),a("button",{staticClass:"btn btn-primary btn-lg shadow",attrs:{id:"merge-button"},on:{click:t.mergeSelectedPatients}},[t._v(" Merge ")])])},r=[],i=(a("4de4"),a("a434"),a("96cf"),a("1da1")),s=a("8051"),c=a("50e8"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"patient-list-container shadow rounded"},[a("form",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),t.triggerSearch(e)}}},[a("div",{staticClass:"input-group mb-2 mr-sm-2"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Name or ARV Number"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}})])]),a("div",{staticClass:"patient-list"},t._l(t.patients,(function(e){return a("PatientListItem",{key:e.patient_id,staticStyle:{width:"96%"},attrs:{patient:e,selected:e.patient_id===t.selectedPatientId},on:{"on-click":t.onPatientCardSelected}})})),1)])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-prepend"},[a("div",{staticClass:"input-group-text"},[a("i",{staticClass:"fas fa-search"})])])}],u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card mb-2 shadow-lg card-hover",class:t.selected&&"card-selected",staticStyle:{width:"100%"},on:{click:t.triggerOnClick}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4"},[a("img",{staticClass:"card-img rounded-circle",staticStyle:{padding:"10%"},attrs:{src:t.imageType,alt:"avatar"}})]),a("div",{staticClass:"col-md-8"},[a("div",{staticClass:"card-body"},[a("h5",{staticClass:"card-title",staticStyle:{float:"left"}},[t._v(t._s(t.full_name))]),a("p",{staticClass:"card-text",staticStyle:{float:"left"}},[t._v(t._s(t.formatted_age))]),a("p",{staticClass:"card-text",staticStyle:{float:"left"}},[t._v("ARV Number: "+t._s(t.arvNumber))])])])])])},d=[],f=(a("99af"),a("b0c0"),a("c1df")),p=a.n(f),m={props:["patient","selected"],data:function(){return{ARV_number:1}},mounted:function(){},computed:{full_name:function(){return" ".concat(this.patient["person"].names[0].given_name," ").concat(this.patient.person.names[0].family_name," ")},formatted_age:function(){return" ".concat(p()(this.patient.person.birthdate).format("DD-MMM-YYYY")," (").concat(p()().diff(this.patient.person.birthdate,"years",!1)," years old)")},imageType:function(){return"M"===this.patient.person.gender?a("cf38"):a("3558")},arvNumber:function(){var t=this.patient.patient_identifiers.filter((function(t){return"ARV Number"===t.type.name}));return t.length>0?t[0].identifier:"N/A"}},methods:{triggerOnClick:function(){this.$emit("on-click",this.patient.patient_id)}}},h=m,g=(a("e453"),a("2877")),v=Object(g["a"])(h,u,d,!1,null,"5b590af9",null),P=v.exports,b={components:{PatientListItem:P},props:["patients"],data:function(){return{searchText:"",selectedPatientId:null}},methods:{triggerSearch:function(){this.$emit("on-search",this.searchText)},onPatientCardSelected:function(t){this.selectedPatientId=t,this.$emit("on-patient-selected",t)}}},_=b,C=(a("c782"),Object(g["a"])(_,o,l,!1,null,"cc3946ae",null)),x=C.exports,w=a("3df9"),S={components:{PatientList:x,PageView:w["a"]},props:["patients"],data:function(){return{targetPatients:[],targetName:null,targetPatientId:null,sourcePatients:[],sourceName:null,sourcePatientId:null,errors:[]}},methods:{searchTargetPatients:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c["a"].searchPatients({searchText:t});case 3:e.targetPatients=a.sent,a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),alert(a.t0);case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},searchSourcePatients:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c["a"].searchPatients({searchText:t});case 3:e.sourcePatients=a.sent,a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),alert(a.t0);case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()},onSelectTargetPatient:function(t){this.targetPatientId=t},onSelectSourcePatient:function(t){this.sourcePatientId=t},onDeleteError:function(t){this.errors.splice(t,1)},mergeSelectedPatients:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.validateSelection()){e.next=2;break}return e.abrupt("return");case 2:return a=[{doc_id:null,patient_id:t.sourcePatientId}],n={doc_id:null,patient_id:t.targetPatientId},e.next=6,s["a"].post("dde/patients/merge",{secondary:a,primary:n,program_id:1});case 6:if(r=e.sent,200===r.status){e.next=13;break}return e.next=10,r.text();case 10:return i=e.sent,t.errors=["Merge failed: API responded: ".concat(i)],e.abrupt("return");case 13:t.sourcePatients=t.sourcePatients.filter((function(e){var a=e.patient_id;return a!=t.sourcePatientId})),t.targetPatients=t.targetPatients.filter((function(e){var a=e.patient_id;return a!=t.sourcePatientId})),t.sourcePatientId=null;case 16:case"end":return e.stop()}}),e)})))()},validateSelection:function(){return this.targetPatientId?this.sourcePatientId?this.targetPatientId!==this.sourcePatientId||(this.errors=["Can't merge patient to self"],!1):(this.errors=["Please select a source patient"],!1):(this.errors=["Please select a target patient"],!1)}}},y=S,k=(a("7634"),Object(g["a"])(y,n,r,!1,null,"2b7edd8f",null));e["default"]=k.exports}}]);
//# sourceMappingURL=chunk-26ce5b80.5bc9ca21.js.map