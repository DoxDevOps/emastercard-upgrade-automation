(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74ed8814"],{"14cb":function(t,e,a){"use strict";var n=a("f7e7"),r=a.n(n);r.a},"29bc":function(t,e,a){"use strict";var n=a("be43"),r=a.n(n);r.a},"30fb":function(t,e,a){"use strict";var n=a("8111"),r=a.n(n);r.a},"498a":function(t,e,a){"use strict";var n=a("23e7"),r=a("58a8").trim,i=a("c8d2");n({target:"String",proto:!0,forced:i("trim")},{trim:function(){return r(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var n=a("1d80"),r=a("5899"),i="["+r+"]",s=RegExp("^"+i+i+"*"),o=RegExp(i+i+"*$"),u=function(t){return function(e){var a=String(n(e));return 1&t&&(a=a.replace(s,"")),2&t&&(a=a.replace(o,"")),a}};t.exports={start:u(1),end:u(2),trim:u(3)}},7590:function(t,e,a){"use strict";var n=a("e69d"),r=a.n(n);r.a},"7c67":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"d-flex",attrs:{id:"wrapper"}},[a("side-bar"),a("div",{attrs:{id:"page-content-wrapper"}},[a("top-nav"),a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("patient-information")],1),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.show("encounter-modal")}}},[t._v("Add Visit")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.show("outcome-modal")}}},[t._v("Update Outcome")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.$bvModal.show("viral-load-modal")}}},[t._v("Viral Load")]),a("div",{staticClass:"row",staticStyle:{margin:"10px","margin-top":"5px"}},[a("visit-data")],1),a("b-modal",{attrs:{id:"encounter-modal",title:"encounter",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}])},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("label",{attrs:{for:"encounter-datepicker"}},[t._v("Choose a visit date")]),a("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"encounter-datepicker"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)]),a("encounter",{attrs:{date:t.date}})],1),a("b-modal",{attrs:{id:"outcome-modal",title:"outcome",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}])},[a("outcome")],1),a("b-modal",{attrs:{id:"viral-load-modal",title:"encounter",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}])},[a("viral-load",{ref:"viral-load"})],1)],1)],1)],1)])},r=[],i=a("ebd8"),s=a("7c08"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid card",staticStyle:{"margin-top":"35px"}},[a("button",{staticClass:"btn btn-info",staticStyle:{"z-index":"1",position:"absolute",left:"47.5%",bottom:"99%","font-size":"13px"},on:{click:function(e){return t.redirect("/registration/"+t.patientID+"/false")}}},[t._v("Edit/Void")]),a("div",{staticClass:"container-fluid",staticStyle:{"margin-top":"8px"}},[a("table",{staticClass:"row"},[a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(0),a("div",{staticClass:"col-md-6 information",attrs:{"data-toggle":"modal"},on:{click:function(e){return t.$bvModal.show("arv-number-modal")}}},[a("p",[t._v(t._s(t.arvNumber))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("patient-info-modal")}}},[t._m(1),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.name))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("patient-info-modal")}}},[t._m(2),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.age)+" ("+t._s(t.initialAge)+")")])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("patient-info-modal")}}},[t._m(3),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.sex))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(4),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.initialWeight))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(5),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.initialHeight))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(6),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.bmi))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(7),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.ti))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("patient-info-modal")}}},[t._m(8),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.landmark))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("patient-info-modal")}}},[t._m(9),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.phoneNumber))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row",on:{click:function(e){return t.$bvModal.show("guardian-info-modal")}}},[t._m(10),t.guardianFirstName?a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.guardianFirstName+" "+t.guardianLastName+" ("+t.guardianRelation+") ("+t.guardianNumber+")"))])]):t._e()])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(11),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.dateOfHIVTest)+" "+t._s(t.placeOfHIVTest))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(12),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.followUp))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(13),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.parseStartDate))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(14),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.startReason))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(15),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.pregnant))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(16),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.breastfeeding))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(17),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.tbLastTwoYears))])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[t._m(18),a("div",{staticClass:"col-md-6 information"},[a("p",[t._v(t._s(t.kaposisSarcoma))])])])])])]),a("b-modal",{attrs:{id:"arv-number-modal",title:"Edit ARV number",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}])},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("label",{attrs:{for:"exampleFormControlSelect1"}},[t._v(t._s(t.arvNumber)+" ->")])]),a("div",{staticClass:"col"},[a("b-input-group",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{prepend:t.sitePrefix+"-ARV-"}},[a("b-input",{attrs:{id:"inline-form-input-username",type:"number"},model:{value:t.arv_num,callback:function(e){t.arv_num=e},expression:"arv_num"}})],1)],1),a("div",{staticClass:"col"},[a("button",{staticClass:"btn btn-primary",on:{click:t.saveARVNumber}},[t._v("Submit")])])])]),a("b-modal",{attrs:{id:"patient-info-modal",title:"patient detials",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}])},[a("div",[a("b-form",[a("label",{attrs:{for:"text-name"}},[t._v("First Name")]),a("b-input",{attrs:{type:"text",id:"text-name"},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),a("label",{attrs:{for:"text-last-name"}},[t._v("Last Name")]),a("b-input",{attrs:{type:"text",id:"text-last-name"},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}}),a("label",{attrs:{for:"text-phone-number"}},[t._v("Phone Number")]),a("b-input-group",{staticClass:"mb-2"},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:t.phoneNumberUnknown,callback:function(e){t.phoneNumberUnknown=e},expression:"phoneNumberUnknown"}},[t._v("Unknown ")])],1),a("b-input",{attrs:{type:t.inputType,id:"text-phone-number",state:t.numberState,disabled:t.phoneNumberUnknown},model:{value:t.updatedPhoneNumber,callback:function(e){t.updatedPhoneNumber=e},expression:"updatedPhoneNumber"}})],1),a("label",{attrs:{for:"text-address"}},[t._v("Physical Address")]),a("b-input",{attrs:{type:"text",id:"text-address"},model:{value:t.updatedAddress,callback:function(e){t.updatedAddress=e},expression:"updatedAddress"}}),a("label",{attrs:{for:"input-sex"}},[t._v("Sex")]),a("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"inline-form-custom-select-pref",options:[{text:"Male",value:"M"},{text:"Female",value:"F"}]},model:{value:t.updatedSex,callback:function(e){t.updatedSex=e},expression:"updatedSex"}}),a("label",{attrs:{for:"example-datepicker"}},[t._v("Date of birth")]),a("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"example-datepicker"},model:{value:t.updatedDOB,callback:function(e){t.updatedDOB=e},expression:"updatedDOB"}}),a("div",{staticClass:"row justify-content-center"},[a("b-button",{attrs:{variant:"primary"},on:{click:t.updateDetails}},[t._v("Save")])],1)],1)],1)]),t.guardianFirstName?a("b-modal",{attrs:{id:"guardian-info-modal",title:"guardian detials",size:"xl"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[a("div",{staticClass:"w-100"})]},proxy:!0}],null,!1,2596559293)},[a("div",[a("b-form",[a("label",{attrs:{for:"text-name"}},[t._v("First Name")]),a("b-input",{attrs:{type:"text",id:"text-name"},model:{value:t.updatedguardianFirstName,callback:function(e){t.updatedguardianFirstName=e},expression:"updatedguardianFirstName"}}),a("label",{attrs:{for:"text-last-name"}},[t._v("Last Name")]),a("b-input",{attrs:{type:"text",id:"text-last-name"},model:{value:t.updatedguardianLastName,callback:function(e){t.updatedguardianLastName=e},expression:"updatedguardianLastName"}}),a("label",{attrs:{for:"text-phone-number"}},[t._v("Phone Number")]),a("b-input-group",{staticClass:"mb-2"},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-form-checkbox",{attrs:{name:"guardian-check",switch:""},model:{value:t.guardianphoneNumberUnknown,callback:function(e){t.guardianphoneNumberUnknown=e},expression:"guardianphoneNumberUnknown"}},[t._v("Unknown ")])],1),a("b-input",{attrs:{type:t.guardianinputType,id:"guardian-phone-number",state:t.guardianNumberState,disabled:t.guardianphoneNumberUnknown},model:{value:t.updatedguardianNumber,callback:function(e){t.updatedguardianNumber=e},expression:"updatedguardianNumber"}})],1),a("div",{staticClass:"row justify-content-center"},[a("b-button",{attrs:{variant:"primary"},on:{click:t.updateGuardianDetails}},[t._v("Save")])],1)],1)],1)]):t._e()],1)},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("ARV #")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Name")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("DOB and Age at initiation")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Sex")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Initial Weight")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Initial Height")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("BMI")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("TI")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Physical Address")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Phone Number")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Name of Guardian")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Date and Place of HIV Test")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Agrees to follow up")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Date of starting first line ARV Regimen")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Reason for Starting ART")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Pregnant at initiation")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Breastfeeding at initiation")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("TB Status at initiation")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-6"},[a("p",[t._v("Kaposi's Sarcoma")])])}],c=(a("99af"),a("4de4"),a("4160"),a("b0c0"),a("b64b"),a("ac1f"),a("466d"),a("159b"),a("ade3")),l=(a("96cf"),a("1da1")),d=a("8051"),p=a("24ca"),m=a("7833"),v=a("c1df"),h=a.n(v),f=Object(c["a"])({data:function(){return{arvNumber:null,arv_num:null,name:null,firstName:null,lastName:null,age:null,sex:null,updatedDOB:null,updatedSex:null,dob:null,initialWeight:null,initialHeight:null,updatedAddress:null,pregnant:null,breastfeeding:null,bmi:null,ti:null,location:null,landmark:null,occupation:null,nameOfGuardian:null,dateOfHIVTest:null,placeOfHIVTest:null,followUp:null,startDate:null,startReason:null,EPTB:null,PTB:null,kaposisSarcoma:null,tbLastTwoYears:null,patientID:null,sitePrefix:null,showARVNumber:!1,phoneNumber:null,updatedPhoneNumber:null,guardianID:null,guardianFirstName:null,guardianLastName:null,guardianRelation:null,guardianNumber:null,updatedguardianFirstName:null,updatedguardianLastName:null,updatedguardianRelation:null,updatedguardianNumber:null,phoneNumberUnknown:!1,guardianphoneNumberUnknown:!1,obs:[{conceptID:2552},{conceptID:5089,variableName:"initialWeight",valueType:"value_numeric",secondType:"value_text"},{conceptID:5090,variableName:"initialHeight",valueType:"value_numeric",secondType:"value_text"},{conceptID:2137,variableName:"bmi",valueType:"value_numeric",secondType:"value_text"},{conceptID:7881,variableName:"placeOfHIVTest",valueType:"value_text"},{conceptID:7882,variableName:"dateOfHIVTest",valueType:"value_datetime",secondType:"value_text"},{conceptID:7754,variableName:"ti",valueType:"value_coded",secondType:"value_text",returnValue:"Yes",default:"No",params:"value_coded=1065",backupConcept:{conceptID:7751,variableName:"ti",valueType:"value_datetime",secondType:"value_text",returnValue:"Yes",default:"No"}},{conceptID:6131,variableName:"pregnant",valueType:"value_coded",secondType:"value_text",returnValue:"Yes",default:"No",params:"value_coded=1065"},{conceptID:7965,variableName:"breastfeeding",valueType:"value_coded",secondType:"value_text",returnValue:"Yes",default:"No",params:"value_coded=1065"},{conceptID:2552,variableName:"followUp",valueType:"value_coded",secondType:"value_text",returnValue:"Yes",default:"No",params:"value_coded=1065",backupConcept:{conceptID:9685,variableName:"followUp",valueType:"value_datetime",secondType:"value_text",returnValue:"Yes",default:"No",backupConcept:{conceptID:9686,variableName:"followUp",valueType:"value_datetime",secondType:"value_text",returnValue:"Yes",default:"No"}}},{conceptID:7459,variableName:"tbLastTwoYears",valueType:"value_coded",secondType:"value_text",conceptNames:{7454:"TB NOT suspected",7455:"TB suspected",7456:"Confirmed TB NOT on treatment",7458:"Confirmed TB on treatment"}},{conceptID:7563,variableName:"startReason",valueType:"value_coded",secondType:"value_text"},{conceptID:2743,subConcepts:{507:{variableName:"kaposisSarcoma",returnValue:"Yes"}}}],initialObs:[]}},computed:{},methods:{getPatient:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/patients/".concat(this.patientID));case 2:return e=t.sent,t.next=5,e.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getGuardian:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/people/".concat(this.patientID,"/relationships")).then((function(t){t.json().then((function(t){if(t.length>0){e.guardianID=t[0].person_b;var a=t[0]["relation"]["names"][0],n=t[0]["type"]["b_is_to_a"];e.guardianFirstName=a["given_name"],e.guardianLastName=a["family_name"],e.guardianRelation=n,e.updatedguardianFirstName=a["given_name"],e.updatedguardianLastName=a["family_name"],e.updatedguardianRelation=n,e.guardianNumber=e.getAtribute(t[0].relation.person_attributes,12),e.updatedguardianNumber=e.getAtribute(t[0].relation.person_attributes,12),"Unknown"===e.guardianphoneNumber&&(e.guardianphoneNumberUnknown=!0),e.nameOfGuardian=a["given_name"]+" "+a["family_name"]+" ("+n+")"}}))}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getObs:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="/observations?person_id=".concat(this.patientID,"&&concept_id=").concat(e.conceptID),n=e.params?n+"&&"+e.params:n,n=a?n+"&&obs_datetime="+a:n,t.next=5,d["a"].get(n);case 5:return r=t.sent,t.next=8,r.json();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),getConcept:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/concepts/".concat(a)).then((function(t){t.json().then((function(t){n[e.variableName]=t.concept_names[0].name}))}));case 2:case"end":return t.stop()}}),t)})));function e(e,a,n){return t.apply(this,arguments)}return e}(),createOb:function(t,e,a){var n=this;this.$store.state.currentHeight=null,this.getObs(t).then((function(a){if(a.length>0){if(t.returnValue)e[t.variableName]=t.returnValue;else if(t.subConcepts)a.forEach((function(a){try{e[t.subConcepts[a.value_coded].variableName]=t.subConcepts[a.value_coded].returnValue}catch(n){}}));else{var r=a[a.length-1][t.valueType]?a[a.length-1][t.valueType]:a[a.length-1][t.secondType];if(e[t.variableName]="value_datetime"===t.valueType&&!1!==t.format?h()(r).format("DD-MMM-YYYY"):r,"value_coded"===t.valueType&&(t.conceptNames?e[t.variableName]=t.conceptNames[r]:n.getConcept(t,r,e)),5089===t.conceptID){var i=a[0][t.valueType]?a[0][t.valueType]:a[0][t.secondType];p["a"].$emit("set-initial-weight",i),n.$store.commit("setWeight",i)}if(5090===t.conceptID){var s=a[0][t.valueType]?a[0][t.valueType]:a[0][t.secondType];p["a"].$emit("set-previous-height",s),n.$store.commit("setHeight",s)}}2552===t.conceptID&&n.$store.commit("setInitialRegistration",a[a.length-1]),5089===t.conceptID&&n.$store.commit("setInitialVitals",a[a.length-1]),7563===t.conceptID&&n.$store.commit("setInitialStaging",a[a.length-1])}else t.backupConcept&&n.createOb(t.backupConcept,e),t.default?e[t.variableName]=t.default:e[t.variableName]="N/A"}))},obsService:function(t){switch(key){case value:break;default:break}},getAtribute:function(t,e){var a=t.filter((function(t){return t.person_attribute_type_id==e}));return a.length>0?a[0].value:""},getPrefix:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].getSitePrefix();case 2:this.sitePrefix=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),saveARVNumber:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="".concat(this.sitePrefix,"-ARV-").concat(this.arv_num),a={identifier:e,identifier_type:4,patient_id:this.$route.params.id},t.next=4,d["a"].post("/patient_identifiers/",a);case 4:n=t.sent,201===n.status||200===n.status?(this.showMessage("ARV number updated"),this.arvNumber=e,this.$root.$emit("bv::hide::modal","arv-number-modal","#btnShow")):400===n.status&&this.showMessage("ARV number already in use");case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showMessage:function(t){this.$toasted.show(t,{theme:"toasted-primary",position:"top-right",duration:5e3})},updateDetails:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={},a=[],"".concat(this.firstName," ").concat(this.lastName)!==this.name&&(e.given_name=this.firstName,e.family_name=this.lastName),this.updatedDOB!==this.dob&&(e.birthdate=this.updatedDOB,e.birthdate_estimated=0),this.updatedSex!==this.sex&&(e.gender=this.updatedSex),this.updatedPhoneNumber!==this.phoneNumber&&(this.numberState||a.push("fix phone number"),this.phoneNumberUnknown&&(e.cell_phone_number="Unknown"),e.cell_phone_number=this.updatedPhoneNumber),this.updatedAddress!==this.landmark&&(e.landmark=this.updatedAddress),!(Object.keys(e).length>0&&0===a.length)){t.next=14;break}return t.next=10,d["a"].put("/people/".concat(this.$route.params.id),e);case 10:n=t.sent,201===n.status||200===n.status?(this.showMessage("Successfully saved"),"".concat(this.firstName," ").concat(this.lastName)!==this.name&&(this.name="".concat(this.firstName," ").concat(this.lastName)),this.updatedDOB!==this.dob&&(this.dob=this.updatedDOB,this.age=" ".concat(h()(this.dob).format("DD-MMM-YYYY"))),this.updatedSex!==this.sex&&(this.sex=this.updatedSex),this.updatedPhoneNumber!==this.phoneNumber&&(this.phoneNumber=this.updatedPhoneNumber),this.updatedAddress!==this.landmark&&(this.landmark=this.updatedAddress),this.$root.$emit("bv::hide::modal","patient-info-modal","#btnShow")):console.log("Failed to update"),t.next=15;break;case 14:a.forEach((function(t){r.showMessage(t)}));case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),updateGuardianDetails:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e={},a=[],this.guardianFirstName!==this.updatedguardianFirstName&&(e.given_name=this.updatedguardianFirstName),this.guardianLastName!==this.updatedguardianLastName&&(e.family_name=this.updatedguardianLastName),this.updatedguardianNumber!==this.guardianNumber&&(this.guardianNumberState||a.push("fix phone number"),this.guardianphoneNumberUnknown&&(e.cell_phone_number="Unknown"),e.cell_phone_number=this.updatedguardianNumber),!(Object.keys(e).length>0)){t.next=12;break}return t.next=8,d["a"].put("/people/".concat(this.guardianID),e);case 8:n=t.sent,201===n.status||200===n.status?(this.showMessage("Successfully saved"),this.guardianFirstName!==this.updatedguardianFirstName&&(this.guardianFirstName=this.updatedguardianFirstName),this.guardianLastName!==this.updatedguardianLastName&&(this.guardianLastName=this.updatedguardianLastName),this.updatedguardianNumber!==this.guardianNumber&&(this.guardianNumber=this.updatedguardianNumber),this.$root.$emit("bv::hide::modal","guardian-info-modal","#btnShow")):console.log("Failed to update"),t.next=13;break;case 12:this.$root.$emit("bv::hide::modal","guardian-info-modal","#btnShow");case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),redirect:function(t){this.$router.push(t)},parseObs:function(t){var e=this;this.obs.forEach((function(a){e.createOb(a,e,t)}))},getStartDate:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$store.state.currentHeight=null,e={conceptID:2516,variableName:"startDate",valueType:"value_datetime",secondType:"value_text",format:!1},this.getObs(e).then((function(t){t.length>0?(a[e.variableName]=t[t.length-1][e.valueType]?t[t.length-1][e.valueType]:t[t.length-1][e.secondType],a.parseObs(a[e.variableName])):a.retrieveStarDate().then((function(t){t.length>0?(a[e.variableName]=t[t.length-1].order.start_date,a.parseObs(a[e.variableName])):(a[e.variableName]="N/A",a.parseObs(null))}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),retrieveStarDate:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="/patients/".concat(this.$route.params.id,"/drugs_orders_by_program?program_id=1"),t.next=3,d["a"].get(e);case 3:return a=t.sent,t.next=6,a.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;this.getPrefix(),this.patientID=this.$route.params.id,this.getPatient().then((function(e){t.name="".concat(e["person"].names[0].given_name," ").concat(e.person.names[0].family_name),t.firstName=e["person"].names[0].given_name,t.lastName=e["person"].names[0].family_name,t.dob=e.person.birthdate,t.updatedDOB=e.person.birthdate,t.age=" ".concat(h()(e.person.birthdate).format("DD-MMM-YYYY"));var a=e.patient_identifiers.filter((function(t){return"ARV Number"===t.type.name}));t.arvNumber=a.length>0?a[0].identifier:"N/A",t.sex=e.person.gender,t.updatedSex=e.person.gender,t.location=e.person.addresses.length>0?e.person.addresses[0].city_village:"",t.landmark=t.getAtribute(e.person.person_attributes,19),t.updatedAddress=t.getAtribute(e.person.person_attributes,19),t.occupation=t.getAtribute(e.person.person_attributes,13),t.phoneNumber=t.getAtribute(e.person.person_attributes,12),t.updatedPhoneNumber=t.getAtribute(e.person.person_attributes,12),"Unknown"===t.phoneNumber&&(t.phoneNumberUnknown=!0);var n={name:t.name,dob:e.person.birthdate,age:h()().diff(e.person.birthdate,"years",!1),arvNumber:t.arvNumber,sex:t.sex};t.$store.commit("setPatient",n)})),this.getGuardian(),this.getStartDate(),p["a"].$on("reload-first-visits",(function(e){t.getStartDate()}))}},"computed",{initialAge:function(){var t="N/A";return"N/A"!==this.startDate&&(t=h()(this.startDate).diff(this.dob,"years",!1)),t},parseStartDate:function(){var t=null;return t="N/A"!==this.startDate&&null!==this.startDate?h()(this.startDate).format("DD-MMM-YYYY"):"N/A",t},numberState:function(){var t=!0;return this.phoneNumberUnknown||(t=null!=="".concat(this.updatedPhoneNumber).match(/^(\+?265|0)(((88|99)\d{7})|(1\d{6})|(2\d{8})|(31\d{8}))$/)),t},inputType:function(){var t="number";return this.phoneNumberUnknown?(t="text",this.updatedPhoneNumber="Unknown"):"Unknown"===this.phoneNumber?this.updatedPhoneNumber=null:this.updatedPhoneNumber=this.phoneNumber,t},guardianNumberState:function(){var t=!0;return this.guardianphoneNumberUnknown||(t=null!=="".concat(this.updatedguardianNumber).match(/^(\+?265|0)(((88|99)\d{7})|(1\d{6})|(2\d{8})|(31\d{8}))$/)),t},guardianinputType:function(){var t="number";return this.guardianphoneNumberUnknown?(t="text",this.updatedguardianNumber="Unknown"):"Unknown"===this.guardianphoneNumber?this.updatedguardianNumber=null:this.updatedguardianNumber=this.guardianNumber,t}}),b=f,g=(a("7590"),a("2877")),_=Object(g["a"])(b,o,u,!1,null,"7e616154",null),y=_.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{staticClass:"table table-dark"},[t._m(0),a("tbody",t._l(t.patientVisits,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(t.moment(e.visitDate).format("DD-MMM-YYYY")))]),a("td",[t._v(t._s(e.givenTo))]),a("td",[t._v(t._s(e.weight))]),a("td",[t._v(t._s(e.height))]),a("td",[t._v(t._s(e.pregnant))]),a("td",[t._v(t._s(e.breastfeeding))]),a("td",[t._v(t._s(e.tbStatus))]),a("td",[t._v(t._s(e.sideEffects))]),a("td",[t._v(t._s(e.ARTRegimen)+" ("+t._s(e.dispensed)+")")]),a("td",[t._v(t._s(e.nextAppointment))]),a("td",[t._v(t._s(e.outcome))]),a("td",[t._v(t._s(e.viralLoad))]),a("td",[a("click-confirm",{attrs:{disabled:0===e.encounters.length}},[a("button",{staticClass:"btn btn-danger",attrs:{disabled:0===e.encounters.length},on:{click:function(a){return t.deleteVisit(n,e.encounters)}}},["deleting"===e.state?[a("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}),a("span",{staticClass:"sr-only"},[t._v("Loading...")])]:[a("span",[t._v("X")])]],2)])],1)])})),0)])},w=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Visit Date")]),a("th",[t._v("Given To")]),a("th",[t._v("Weight")]),a("th",[t._v("Height")]),a("th",[t._v("Preg")]),a("th",[t._v("B/F")]),a("th",[t._v("TB status")]),a("th",[t._v("Side Effects")]),a("th",[t._v("ART Regimen")]),a("th",[t._v("Next Appointment")]),a("th",[t._v("Outcome")]),a("th",[t._v("Viral Load")])])])}];a("a4d3"),a("a434"),a("e439"),a("dbb4");function C(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function N(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?C(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var k={data:function(){return{patientVisits:[],mockOBJ:{visitDate:null,givenTo:null,weight:null,height:null,sideEffects:null,ARTRegimen:null,nextAppointment:null,viralLoad:null,outcoume:null,encounters:[],state:null,tbStatus:null,pregnant:null,breastfeeding:null,dispensed:null,adherence:null},encountersToDelete:[],obs:[{conceptID:5089,variableName:"weight",valueType:"value_numeric",secondType:"value_text"},{conceptID:5090,variableName:"height",valueType:"value_numeric",secondType:"value_text"},{conceptID:5096,variableName:"nextAppointment",valueType:"value_datetime",secondType:"value_text"},{conceptID:7459,variableName:"tbStatus",valueType:"value_coded",secondType:"value_text",conceptNames:{7454:"TB NOT suspected",7455:"TB suspected",7456:"Confirmed TB NOT on treatment",7458:"Confirmed TB on treatment"}},{conceptID:856,variableName:"viralLoad",valueType:"value_numeric",secondType:"value_text",prepend:"value_text"},{conceptID:2540,variableName:"adherence",valueType:"value_numeric",secondType:"value_text"}]}},methods:{getVisits:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/patients/".concat(this.$route.params.id,"/visits")).then((function(t){t.json().then((function(t){e.setVisits(t)}))}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),deleteVisit:function(t,e){var a=this,n=e.length;this.patientVisits[t].state="deleting",e.forEach((function(e){a.removeEncounter(e).then((function(e){204==e.status?(n-=1,0===n&&(a.patientVisits.splice(t,1),p["a"].$emit("reload-first-visits",""))):console.log("not deleted")}))}))},getLastOrder:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.$route.params.id,t.next=3,d["a"].get("/programs/1/patients/".concat(a,"/last_drugs_received?date=")+e);case 3:return n=t.sent,t.next=6,n.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),removeEncounter:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].remove("encounters/"+e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),setVisits:function(t){var e=this,a=[];t.forEach((function(t){a.push({visitDate:t,encounters:e})})),this.createOb(a)},getObs:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="/observations?person_id=".concat(this.$route.params.id,"&&concept_id=").concat(e.conceptID,"&&obs_datetime=").concat(a.visitDate),n=e.params?n+"&&"+e.params:n,t.next=4,d["a"].get(n);case 4:return r=t.sent,t.next=7,r.json();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),getEncounters:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="/encounters?patient_id=".concat(this.$route.params.id,"&&date=").concat(e),t.next=3,d["a"].get(a);case 3:return n=t.sent,t.next=6,n.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getCurrentPatientInfo:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="programs/1/patients/".concat(this.$route.params.id,"?date=").concat(e.visitDate),t.next=3,d["a"].get(a);case 3:return n=t.sent,t.next=6,n.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getNextAppointMent:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="programs/1/patients/".concat(this.$route.params.id,"/next_appointment_date"),t.next=3,d["a"].get(e);case 3:return a=t.sent,t.next=6,a.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getConcept:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/concepts/".concat(e));case 2:return a=t.sent,t.next=5,a.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),createOb:function(t){var e=this;t.forEach((function(t){var a=N({},e.mockOBJ);a.visitDate=t.visitDate,e.obs.forEach((function(n){e.getObs(n,t).then((function(r){if(r.length>0)if(n.returnValue)t.variableName=n.returnValue;else if(n.subConcepts)r.forEach((function(e){try{t.subConcepts[e.value_coded].variableName=t.subConcepts[e.value_coded].returnValue}catch(a){}}));else{var i=r[r.length-1][n.valueType]?r[r.length-1][n.valueType]:r[r.length-1][n.secondType];a[n.variableName]="value_datetime"===n.valueType?h()(i).format("DD-MMM-YYYY"):i,"value_coded"===n.valueType&&(n.conceptNames?a[n.variableName]=n.conceptNames[i]:e.getConcept(i).then((function(t){a[n.variableName]=t.concept_names[0].name}))),n.prepend&&(a[n.variableName]=r[r.length-1][n.prepend]+" "+i)}else n.backupConcept,n.default?t.variableName=n.default:t[n.variableName]="N/A"}))})),e.getCurrentPatientInfo(t).then((function(e){t.ARTRegimen=e.current_regimen,t.outcome=e.current_outcome,a.ARTRegimen=e.current_regimen,a.outcome=e.current_outcome})),e.getObs({conceptID:7755},t).then((function(e){var n=e.filter((function(t,a){return 1065==e[a].children[0].value_coded})).length;n=0===n?"No":"Yes",t.sideEffects=n,a.sideEffects=n})),e.getObs({conceptID:1805,params:"value_coded=1065"},t).then((function(e){e.length>0?(t.givenTo="Patient",a.givenTo="Patient"):(t.givenTo="Guardian",a.givenTo="Guardian")})),e.getObs({conceptID:6131,params:"value_coded=1065"},t).then((function(e){e.length>0?(t.pregnant="Yes",a.pregnant="Yes"):(t.pregnant="",a.pregnant="")})),e.getObs({conceptID:7965,params:"value_coded=1065"},t).then((function(e){e.length>0?(t.breastfeeding="Yes",a.breastfeeding="Yes"):(a.breastfeeding="",t.breastfeeding="")})),e.getEncounters(t.visitDate).then((function(t){var e=[];t.forEach((function(t){e.push(t.encounter_id)})),a.encounters=[].concat(e)})),e.getLastOrder(t.visitDate).then((function(e){e.length>0&&(t.dispensed=e[0].quantity,a.dispensed=e[0].quantity)})),e.patientVisits.push(a)}))},returnConcept:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;this.getVisits(),p["a"].$on("reload-visits",(function(e){t.patientVisits=[],t.encountersToDelete=[],t.getVisits()}))}},O=k,D=(a("30fb"),Object(g["a"])(O,x,w,!1,null,"f352e4dc",null)),T=D.exports,E=a("8740"),$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("vitals",{ref:"vitals",on:{addEncounter:t.addEncounter}}),a("consultation",{ref:"consultation",on:{addEncounter:t.addEncounter}}),a("prescription",{ref:"prescription",attrs:{date:t.date},on:{addEncounter:t.addEncounter}}),a("reception",{ref:"reception",on:{addEncounter:t.addEncounter}}),a("adherence",{ref:"adherence",attrs:{date:t.date},on:{addEncounter:t.addEncounter}}),a("appointment",{ref:"appointment",attrs:{date:t.date},on:{addEncounter:t.addEncounter}}),a("button",{staticClass:"btn btn-primary",on:{click:t.createEncounters}},[!0===t.posting?[a("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}),a("span",{staticClass:"sr-only"},[t._v("Loading...")])]:[a("span",[t._v("Save")])]],2)],1)},R=[],S=(a("caad"),a("2532"),a("53ba")),P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row "},[t._m(0),a("div",{staticClass:"col"},[a("fieldset",[a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.patient.value_coded,expression:"patient.value_coded"}],staticClass:"form-check-input",attrs:{type:"radio",value:"1065",name:"patient",disabled:t.hasWeight},domProps:{checked:t._q(t.patient.value_coded,"1065")},on:{change:function(e){return t.$set(t.patient,"value_coded","1065")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"inlineRadio1"}},[t._v("Yes")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.patient.value_coded,expression:"patient.value_coded"}],staticClass:"form-check-input",attrs:{type:"radio",value:"1066",name:"patient",disabled:t.hasWeight},domProps:{checked:t._q(t.patient.value_coded,"1066")},on:{change:function(e){return t.$set(t.patient,"value_coded","1066")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"inlineRadio2"}},[t._v("No")])])])]),t._m(1),a("div",{staticClass:"col"},[a("fieldset",[a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.guardian.value_coded,expression:"guardian.value_coded"}],staticClass:"form-check-input",attrs:{type:"radio",value:"1065",name:"guardian",disabled:t.hasWeight},domProps:{checked:t._q(t.guardian.value_coded,"1065")},on:{change:function(e){return t.$set(t.guardian,"value_coded","1065")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"inlineRadio1"}},[t._v("Yes")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.guardian.value_coded,expression:"guardian.value_coded"}],staticClass:"form-check-input",attrs:{type:"radio",value:"1066",name:"guardian",disabled:t.hasWeight},domProps:{checked:t._q(t.guardian.value_coded,"1066")},on:{change:function(e){return t.$set(t.guardian,"value_coded","1066")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"inlineRadio2"}},[t._v("No")])])])])])])},j=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col d-flex justify-content-start"},[a("p",[t._v("Drugs given to patient")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col d-flex justify-content-start"},[a("p",[t._v("Drugs given to guardian")])])}],I={data:function(){return{patient:{value_coded:null,concept_id:1805},guardian:{value_coded:null,concept_id:2122},hasWeight:!1}},methods:{saveEncounter:function(){var t={reception:{encounter_id:51,obs:{patient:this.patient,guardian:this.guardian}}};this.$emit("addEncounter",t)},setPresent:function(){"1066"===this.patient.value_coded?this.guardian.value_coded="1065":"1065"===this.patient.value_coded?this.guardian.value_coded="1066":"1066"===this.guardian.value_coded?this.patient.value_coded="1065":"1065"===this.guardian.value_coded&&(this.patient.value_coded="1066"),p["a"].$emit("set-present",this.patient.value_coded)}},watch:{patient:{handler:function(t){this.setPresent()},deep:!0},guardian:{handler:function(t){this.setPresent()},deep:!0}},mounted:function(){var t=this;p["a"].$on("set-weight",(function(e){null!==e&&""!==e&&0!==e?(t.patient.value_coded="1065",t.guardian.value_coded="1066",t.hasWeight=!0):(t.patient.value_coded=null,t.guardian.value_coded=null,t.hasWeight=!1)}))}},A=I,Y=Object(g["a"])(A,P,j,!1,null,null,null),M=Y.exports,V=a("f91c"),F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-row",[a("b-col",[a("label",{attrs:{for:"appointment-datepicker"}},[t._v("Choose an appointment date")]),a("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"appointment-datepicker",min:t.date},model:{value:t.appointmentdate.value_datetime,callback:function(e){t.$set(t.appointmentdate,"value_datetime",e)},expression:"appointmentdate.value_datetime"}})],1)],1)},q=[],L={props:["date"],data:function(){return{appointmentdate:{value_datetime:null,concept_id:5096}}},methods:{saveEncounter:function(){var t={hiv_staging:{encounter_id:7,obs:{date:this.appointmentdate}}};this.$emit("addEncounter",t)}}},B=L,U=Object(g["a"])(B,F,q,!1,null,null,null),W=U.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("b-row",[a("b-col",[t.isFemale?a("b-form-group",{attrs:{label:"Pregnant"}},[a("b-form-radio",{attrs:{name:"pregnant-radios",value:"1065",inline:""},model:{value:t.pregnant.value_coded,callback:function(e){t.$set(t.pregnant,"value_coded",e)},expression:"pregnant.value_coded"}},[t._v("Yes")]),a("b-form-radio",{attrs:{name:"pregnant-radios",value:"1066",inline:""},model:{value:t.pregnant.value_coded,callback:function(e){t.$set(t.pregnant,"value_coded",e)},expression:"pregnant.value_coded"}},[t._v("No")])],1):t._e()],1),a("b-col",[t.isFemale?a("b-form-group",{attrs:{label:"Breastfeeding"}},[a("b-form-radio",{attrs:{name:"breastfeeding-radios",value:"1065",inline:""},model:{value:t.breastFeeding.value_coded,callback:function(e){t.$set(t.breastFeeding,"value_coded",e)},expression:"breastFeeding.value_coded"}},[t._v("Yes")]),a("b-form-radio",{attrs:{name:"breastfeeding-radios",value:"1066",inline:""},model:{value:t.breastFeeding.value_coded,callback:function(e){t.$set(t.breastFeeding,"value_coded",e)},expression:"breastFeeding.value_coded"}},[t._v("No")])],1):t._e()],1),a("b-col",[a("b-form-select",{attrs:{options:t.tb_status},model:{value:t.currentStatus,callback:function(e){t.currentStatus=e},expression:"currentStatus"}})],1),a("b-col",[a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:t.hasSE,callback:function(e){t.hasSE=e},expression:"hasSE"}},[t._v("Has Side Effects / Contraindications?")]),a("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse-1"},model:{value:t.hasSE,callback:function(e){t.hasSE=e},expression:"hasSE"}},[a("b-card",[a("b-form-group",{attrs:{label:"Side Effects:"}},[a("b-form-checkbox-group",{attrs:{id:"checkbox-group-1",options:t.sideEffects,name:"flavour-1"},model:{value:t.sides,callback:function(e){t.sides=e},expression:"sides"}})],1),a("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:t.otherSE,callback:function(e){t.otherSE=e},expression:"otherSE"}},[t._v("Other")]),a("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse-1-inner"},model:{value:t.otherSE,callback:function(e){t.otherSE=e},expression:"otherSE"}},[a("b-card",[a("b-form-checkbox-group",{attrs:{options:t.otherSideEffects},model:{value:t.otherSides,callback:function(e){t.otherSides=e},expression:"otherSides"}})],1)],1)],1)],1)],1)],1)],1)])},z=[],G={data:function(){return{gender:null,pregnant:{value_coded:null,concept_id:6131},breastFeeding:{value_coded:null,concept_id:7965},onTb:{value_coded:null,concept_id:2690},currentStatus:null,fpm:{"Oral contraceptive pills":780,"Depo-Provera":907,"Intrauterine device/loop":5275,Implant:7857,"Male condoms":7858,"Female condoms":7859,"Tubal ligation":1719,"None of the above":1107},tb_status:[{value:null,text:"TB Status"},{value:7454,text:"TB Not Suspected"},{value:7455,text:"TB Suspected"},{value:7456,text:"Confirmed TB Not on treatment"},{value:7458,text:"Confirmed TB on treatment"}],drugs:{ARVs:1085,CPT:916,IPT:656},tbSymptoms:{"cough of any duration":8261,fever:5945,"night sweats":6029,"Weight loss / Failure to thrive / malnutritionweight loss":8260},sideEffects:[{text:"peripheral neuropaphy",value:821},{text:"jaundince",value:215},{text:"lipodostrophy",value:2148},{text:"kidney failure",value:9242},{text:"psychosis",value:219},{text:"gynaecomastia",value:9440},{text:"anemia",value:3},{text:"skin rash",value:512},{text:"insomnia",value:867}],otherSideEffects:[{text:"fever",value:5945},{text:"vomiting",value:5980},{text:"dizziness",value:877},{text:"headache",value:620},{text:"nausea",value:5978},{text:"weight loss",value:8260},{text:"lactic acidosis",value:1458},{text:"cough",value:107}],prescribedFPM:[],currentFPM:[],sides:[],otherSides:[],tbSymps:[],drugsToPrescribe:[],onFP:!1,prescribeFP:!1,hasSE:!1,otherSE:!1,hasTBSymps:!1,statusTB:null}},computed:{isFemale:function(){return"F"===this.$store.state.patient.sex}},methods:{saveEncounter:function(){var t=this,e={consultation:{encounter_id:53,obs:{tb:{value_coded:this.currentStatus,concept_id:7459}}}};this.isFemale&&(e.consultation.obs.pregnant=this.pregnant,e.consultation.obs.breastFeeding=this.breastFeeding,e.consultation.obs.onFP={concept_id:1717,value_coded:1066},Object.keys(this.fpm).forEach((function(a){e.consultation.obs["pres"+a]={concept_id:t.fpm[a],value_coded:t.getCoded(t.prescribedFPM,t.fpm[a])}})),Object.keys(this.fpm).forEach((function(a){e.consultation.obs["curr"+a]={concept_id:t.fpm[a],value_coded:t.getCoded(t.currentFPM,t.fpm[a])}})),this.onFP&&(e.consultation.obs.onFP.value_coded=1065)),this.sideEffects.forEach((function(a){e.consultation.obs[a.text]={concept_id:7755,value_coded:a.value,child:{concept_id:a.value,value_coded:t.getCoded(t.sides,a.value)}}})),this.otherSE&&this.otherSideEffects.forEach((function(a){e.consultation.obs[a.text]={concept_id:7951,value_coded:a.value,child:{concept_id:a.value,value_coded:t.getCoded(t.otherSides,a.value)}}})),Object.keys(this.tbSymptoms).forEach((function(a){e.consultation.obs[a]={concept_id:t.tbSymptoms[a],value_coded:t.tbSymptoms[a],child:{concept_id:t.tbSymptoms[a],value_coded:t.getCoded(t.tbSymps,t.tbSymptoms[a])}}})),this.drugsToPrescribe.forEach((function(t){e.consultation.obs[t]={concept_id:1282,value_coded:t}})),this.$emit("addEncounter",e)},getCoded:function(t,e){return t.includes(e)?1065:1066}},watch:{onTb:{handler:function(t){p["a"].$emit("set-tb",this.onTb.value_coded)},deep:!0}}},Z=G,J=(a("14cb"),Object(g["a"])(Z,H,z,!1,null,"d407baf8",null)),Q=J.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputState"}},[t._v("Regimen")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedRegimen,expression:"selectedRegimen"}],staticClass:"form-control",attrs:{id:"inputState"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedRegimen=e.target.multiple?a:a[0]}}},t._l(t.regimens,(function(e,n){return a("option",{key:n},[t._v(t._s(n))])})),0)]),a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputZip"}},[t._v("Quantity")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.ARVquantity,expression:"ARVquantity"}],staticClass:"form-control",attrs:{type:"number",id:"inputZip"},domProps:{value:t.ARVquantity},on:{input:function(e){e.target.composing||(t.ARVquantity=e.target.value)}}})])]),a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputZip"}},[t._v("CPT Quantity")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.CPTquantity,expression:"CPTquantity"}],staticClass:"form-control",attrs:{type:"number",id:"inputZip"},domProps:{value:t.CPTquantity},on:{input:function(e){e.target.composing||(t.CPTquantity=e.target.value)}}})]),a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputZip"}},[t._v("IPT Quantity")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.IPTquantity,expression:"IPTquantity"}],staticClass:"form-control",attrs:{type:"number",id:"inputZip"},domProps:{value:t.IPTquantity},on:{input:function(e){e.target.composing||(t.IPTquantity=e.target.value)}}})])])])},K=[],tt=(a("498a"),{props:["date"],data:function(){return{regimens:[],selectedRegimen:null,selectedDrugs:[],drugOrder:[],nextAppointment:null,ARVquantity:null,CPTquantity:null,IPTquantity:null,prescribeARVs:!1,prescribeCPT:!1,prescribeIPT:!1,weight:null,latestWeight:null,CPTRegimens:[],IPTRegimens:[],onTb:!1}},methods:{getRegimens:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$route.params.id,t.next=3,d["a"].get("/programs/1/regimens?weight=".concat(this.weight,"&tb_dosage=true")).then((function(t){t.json().then((function(t){a.regimens=t}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getCPT:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$route.params.id,t.next=3,d["a"].get("/programs/1/regimen_extras?weight=".concat(this.weight,"&name=Cotrimoxazole")).then((function(t){t.json().then((function(t){e.CPTRegimens=t}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getIPT:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.$route.params.id,t.next=3,d["a"].get("/programs/1/regimen_extras?weight=".concat(this.weight,"&name=INH")).then((function(t){t.json().then((function(t){e.IPTRegimens=t}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),saveEncounter:function(){var t=this,e=[];this.selectedDrugs=[];var a=this.regimens[this.selectedRegimen],n={};this.ARVquantity&&this.selectedRegimen&&(a.forEach((function(e){t.selectedDrugs.push({drug_name:e.drug_name,drug_id:e.drug_id,units:e.units,am:e.am,pm:e.pm,quantity:t.ARVquantity})})),n.prescribeARV={concept_id:1282,value_coded:1085}),this.CPTquantity&&(this.CPTRegimens.forEach((function(e){t.selectedDrugs.push({drug_name:e.drug_name,drug_id:e.drug_id,units:e.units,am:e.am,pm:e.pm,quantity:t.CPTquantity})})),n.prescribeCPT={concept_id:1282,value_coded:916}),this.IPTquantity&&(this.IPTRegimens.forEach((function(e){t.selectedDrugs.push({drug_name:e.drug_name,drug_id:e.drug_id,units:e.units,am:e.am,pm:e.pm,quantity:t.IPTquantity})})),n.prescribeIPT={concept_id:1282,value_coded:656});for(var r=0;r<this.selectedDrugs.length;r++){var i=parseFloat(this.selectedDrugs[r]["am"]),s=parseFloat(this.selectedDrugs[r]["pm"]),o="ONCE A DAY (OD)",u=i+s,c=this.selectedDrugs[r].drug_name+":- Morning: "+i+" tab(s), Evening: "+s+" tabs",l=0;0==s&&(l=i),0==i&&(l=s),i>0&&s>0&&(o="TWICE A DAY (BD)",l=(i+s)/2);var d={drug_inventory_id:this.selectedDrugs[r].drug_id,dose:l,equivalent_daily_dose:u,frequency:o,start_date:h()(this.date).format("YYYY-MM-DD"),auto_expire_date:h()(this.date).add(this.quantity/u+2,"days").format("YYYY-MM-DD"),instructions:c,units:this.selectedDrugs[r].units,qty:this.selectedDrugs[r].quantity};"Cotrimoxazole (480mg tablet)"===this.selectedDrugs[r].drug_name||e.push(d)}var p={prescription:{encounter_id:25,drug_orders:e}},m={consultation2:{encounter_id:53,obs:n}};this.$emit("addEncounter",p),this.$emit("addEncounter",m)}},mounted:function(){var t=this;this.latestWeight=this.$store.state.currentWeight,this.weight=this.latestWeight,this.getRegimens(),p["a"].$on("set-weight",(function(e){t.selectedRegimen=null,t.ARVquantity=null,""===e.trim()?t.weight=t.latestWeight:t.weight=e,t.getRegimens(),t.getCPT(),t.getIPT()})),p["a"].$on("set-initial-weight",(function(e){t.latestWeight=e,t.weight=e,t.getRegimens(),t.getCPT(),t.getIPT()})),p["a"].$on("set-tb",(function(e){t.onTb="1065"===e}))}}),et=tt,at=Object(g["a"])(et,X,K,!1,null,null,null),nt=at.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("label",{attrs:{for:"inputState"}},[t._v("Pill Count: Last dispensation("+t._s(t.previousDispensation)+")")])]),a("div",{staticClass:"form-group col-md-6"},[t.previousDispensation>0?a("input",{directives:[{name:"model",rawName:"v-model",value:t.pillCount,expression:"pillCount"}],staticClass:"form-control",attrs:{type:"number",id:"pill-count"},domProps:{value:t.pillCount},on:{input:function(e){e.target.composing||(t.pillCount=e.target.value)}}}):t._e()])])])},it=[];function st(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function ot(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?st(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):st(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var ut={props:["date"],data:function(){return{pillCount:null,lastDrugs:[],adherence:0}},methods:{saveEncounter:function(){var t=this,e={},a=6987,n=2540;this.lastDrugs.forEach((function(r){var i=t.calculateExpected(r.quantity,r.equivalent_daily_dose,r.order.start_date),s=t.calculateAdherence(r.quantity,t.pillCount,i);e["adherence"+r.order_id]={concept_id:a,value_drug:r.drug_inventory_id,order_id:r.order_id,value_numeric:s,value_modifier:"%",person_id:t.$route.params.id},e["amount"+r.order_id]={concept_id:n,order_id:r.order_id,value_numeric:t.pillCount,person_id:t.$route.params.id}}));var r={adherence:{encounter_id:68,obs:ot({},e)}};this.$emit("addEncounter",r)},calculateExpected:function(t,e,a){var n=new Date(this.date),r=new Date(a),i=this.dateDiffInDays(r,n);return t-i*parseFloat(e)},calculateAdherence:function(t,e,a){return Math.round(100*(t-e)/(t-a))},getLastOrder:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lastDrugs=[],a=this.$route.params.id,t.next=4,d["a"].get("/programs/1/patients/".concat(a,"/last_drugs_received?date=")+e).then((function(t){t.json().then((function(t){t.length>0&&(n.lastDrugs=t)}))}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),dateDiffInDays:function(t,e){var a=Math.abs(e.getTime()-t.getTime()),n=Math.ceil(a/864e5);return n}},mounted:function(){this.getLastOrder(this.date),p["a"].$on("change-date",(function(t){}))},watch:{date:function(t,e){this.getLastOrder(t)}},computed:{previousDispensation:function(){return this.lastDrugs.length>0?this.lastDrugs[0].quantity:0}}},ct=ut,lt=Object(g["a"])(ct,rt,it,!1,null,null,null),dt=lt.exports,pt=a("cf40"),mt={props:["date"],data:function(){return{encounters:{},numEnc:0,patientPresent:!1,posting:!1,verifiedEnc:[]}},components:{vitals:S["a"],"clinic-registration":E["a"],reception:M,appointment:W,staging:V["a"],consultation:Q,prescription:nt,adherence:dt},methods:{addEncounter:function(t){var e=Object.keys(t)[0];this.encounters[e]=t[e]},saveEncounter:function(t){var e=this,a=[],n={url:"observations"};Object.keys(t).includes("obs")?(Object.keys(t.obs).forEach((function(n){var r=t.obs[n][e.getExpected(t.obs[n])];null!==r&&""!==r&&a.push(t.obs[n])})),n.observations=a,a.length>0&&(this.verifiedEnc.push(t.encounter_id),this.postEncounter(n,t.encounter_id))):Object.keys(t).includes("drug_orders")&&(n.drug_orders=t.drug_orders,n.url="drug_orders",n.drug_orders.length>0&&(this.verifiedEnc.push(t.encounter_id),this.postEncounter(n,t.encounter_id)))},postEncounter:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r,i,s,o,u,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.$route.params.id,t.next=3,pt["a"].createEncounter(n,a,this.date);case 3:if(r=t.sent,this.successfulOperation=!0,201!==r.status&&200!==r.status){t.next=33;break}return i=r.encounter_id,e.encounter_id=i,t.next=10,d["a"].post(e.url,e);case 10:if(s=t.sent,201!==s.status&&200!==s.status){t.next=28;break}if("drug_orders"!==e.url){t.next=21;break}return t.next=15,s.json();case 15:return o=t.sent,u=[],o.forEach((function(t){var a=e.drug_orders.filter((function(e){return e.drug_inventory_id===t.drug_inventory_id}));u.push({date:c.date,drug_order_id:t.order_id,quantity:a[0]["qty"]})})),t.next=20,d["a"].post("/dispensations",{dispensations:u,program_id:1});case 20:t.sent;case 21:this.numEnc++,this.numEnc===this.verifiedEnc.length&&(this.posting=!1,p["a"].$emit("reload-visits",""),p["a"].$emit("reload-first-visits",""),this.$toasted.show("Encounter Saved",{theme:"toasted-primary",position:"top-right",duration:2e3}),this.$root.$emit("bv::hide::modal","encounter-modal","#btnShow")),this.success=!0,this.fail=!1,this.postResponse="Appointment has been set.",t.next=31;break;case 28:this.$toasted.show("Some Observations failed to save !!",{theme:"toasted-primary",position:"top-right",duration:5e3}),this.fail=!0,this.postResponse="Appointment could not be set.";case 31:t.next=36;break;case 33:this.success=!1,this.fail=!0,this.postResponse="Appointment could not be set.";case 36:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),createEncounters:function(){var t=this;this.posting=!0;var e=Object.keys(this.$refs);e.forEach((function(e){t.$refs[e].saveEncounter()}));var a=Object.keys(this.encounters);a.forEach((function(e){t.saveEncounter(t.encounters[e])}))},getExpected:function(t){var e=["value_group_id","value_boolean","value_coded","value_coded_name_id","value_drug","value_datetime","value_numeric","value_modifier","value_text"],a="";return Object.keys(t).filter((function(t){e.includes(t)&&(a=t)})),a},removeModal:function(){var t=document.getElementById("exampleModalCenter");t.classList.remove("show"),t.setAttribute("aria-hidden","true"),t.setAttribute("style","display: none");var e=document.getElementsByClassName("modal-backdrop");document.body.removeChild(e[0])}},mounted:function(){var t=this;p["a"].$on("set-present",(function(e){t.patientPresent="1066"!==e}))}},vt=mt,ht=Object(g["a"])(vt,$,R,!1,null,null,null),ft=ht.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"input-group mb-3"},[t._m(0),t.states.length>0?a("select",{directives:[{name:"model",rawName:"v-model",value:t.state,expression:"state"}],staticClass:"form-control",attrs:{name:"",id:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.state=e.target.multiple?a:a[0]}}},t._l(t.states,(function(e,n){return a("option",{key:n,domProps:{value:{state_id:e.program_workflow_state_id,name:e.name}}},[t._v(" "+t._s(e.name)+" ")])})),0):t._e()])]),a("div",{staticClass:"col"},[a("div",{staticClass:"input-group mb-3"},[t._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"date"}],staticClass:"form-control",attrs:{type:"date","aria-label":"Default","aria-describedby":"inputGroup-sizing-default"},domProps:{value:t.date},on:{input:function(e){e.target.composing||(t.date=e.target.value)}}})])]),"Patient transferred out"===t.state.name?a("div",{staticClass:"col"},[a("div",{staticClass:"form-group"},[a("v-select",{attrs:{options:t.locations,placeholder:"test location"},on:{search:t.getlocations,input:t.getVal}})],1)]):t._e(),a("div",{staticClass:"col"},[a("button",{staticClass:"btn btn-primary",on:{click:t.postOutcome}},[t._v("Submit")])])]),a("div",{staticClass:"text-center"},t._l(t.errors,(function(e,n){return a("p",{key:n,staticStyle:{color:"red"}},[t._v(" "+t._s(e))])})),0),a("table",{staticClass:"table table-bordered"},[t._m(2),a("tbody",t._l(t.outcomes,(function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(t.moment(e.start_date).format("DD-MMM-YYYY")))]),e.end_date?a("td",[t._v(t._s(t.moment(e.end_date).format("DD-MMM-YYYY")))]):a("td"),a("td",[a("click-confirm",[a("button",{staticClass:"btn btn-danger",on:{click:function(a){return t.voidState(e.patient_state_id,n)}}},[t.voiding?[a("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}),a("span",{staticClass:"sr-only"},[t._v("Loading...")])]:[a("span",[t._v("X")])]],2)])],1)])})),0)])])},gt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-prepend"},[a("span",{staticClass:"input-group-text",attrs:{id:"height"}},[t._v("Outcome")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-prepend"},[a("span",{staticClass:"input-group-text"},[t._v("Outcome Date")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"thead-dark"},[a("tr",[a("th",[t._v("Outcome")]),a("th",[t._v("Start Date")]),a("th",[t._v("End Date")])])])}],_t=(a("6dfc"),a("4a7a")),yt=a.n(_t),xt={components:{"v-select":yt.a},data:function(){return{states:[],errors:[],state:{},outcomes:[],date:null,locations:[],location:null,voiding:!1}},methods:{getOutcomes:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/programs/1/workflows").then((function(t){t.json().then((function(t){e.states=t[0].states}))}));case 2:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getPatientOutcomes:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].get("/patients/".concat(this.$route.params.id,"/programs")).then((function(t){t.json().then((function(t){e.outcomes=t.filter((function(t){return 1===t.program_id}))[0]["patient_states"]}))}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),voidState:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.voiding=!0,n="/programs/1/patients/".concat(this.$route.params.id,"/states/").concat(e,"?reason='duplicate / system error'"),t.next=4,d["a"].remove(n);case 4:r=t.sent,201===r.status||204===r.status?(p["a"].$emit("reload-visits",""),this.$toasted.show("Outcome deleted",{theme:"toasted-primary",position:"top-right",duration:2e3}),this.voiding=!1,this.outcomes.splice(a,1)):(console.log(r.status),console.log("Failed to update"));case 6:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),postOutcome:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.errors=[],0===Object.keys(this.state).length&&this.errors.push("Outcome is required"),null!==this.date&&""!==this.date||this.errors.push("Date is required"),e={state:this.state.state_id,date:h()(this.date).format("YYYY-MM-DD")},"Patient transferred out"===this.state.name&&(e.location_id=this.location,null==this.location&&this.errors.push("Location is required")),0!==this.errors.length){t.next=11;break}return a=this.$route.params.id,t.next=9,d["a"].post("programs/1/patients/".concat(a,"/states"),e);case 9:n=t.sent,201===n.status||200===n.status?(p["a"].$emit("reload-visits",""),this.$toasted.show("Outcome Saved",{theme:"toasted-primary",position:"top-right",duration:2e3}),this.$root.$emit("bv::hide::modal","outcome-modal","#btnShow")):console.log("Failed to update");case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getlocations:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.locations=[],t.next=3,d["a"].get("/locations?name="+e).then((function(t){t.json().then((function(t){t.forEach((function(t){a.locations.push({label:t.name,code:t.name,location_id:t.location_id})}))}))}));case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getVal:function(t){this.location=t.location_id}},mounted:function(){this.getOutcomes(),this.getlocations(sessionStorage.location_name),this.getPatientOutcomes()}},wt=xt,Ct=Object(g["a"])(wt,bt,gt,!1,null,null,null),Nt=Ct.exports,kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"form-group"},[a("v-select",{attrs:{options:t.options,placeholder:"modifier"},model:{value:t.modifier,callback:function(e){t.modifier=e},expression:"modifier"}})],1)]),a("div",{staticClass:"col-md-8"},[a("div",{staticClass:"form-inline"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Viral Load")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.viralLoad,expression:"viralLoad"}],staticClass:"form-control",attrs:{type:"number",name:"",id:"",placeholder:"","aria-describedby":"helpId"},domProps:{value:t.viralLoad},on:{input:function(e){e.target.composing||(t.viralLoad=e.target.value)}}}),a("label",{attrs:{for:""}},[t._v("Date")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"date"}],staticClass:"form-control",attrs:{type:"date",name:"",id:"date",placeholder:"","aria-describedby":"helpId"},domProps:{value:t.date},on:{input:function(e){e.target.composing||(t.date=e.target.value)}}})])])]),a("br"),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:t.saveEncounter}},[t._v("Save")])])])},Ot=[],Dt={components:{"v-select":yt.a},data:function(){return{patient:{value_coded:null,concept_id:1805},guardian:{value_coded:null,concept_id:2122},options:["=",">","<","=>","=<"],modifier:null,viralLoad:null,date:null}},methods:{saveEncounter:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,n,r,i,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.params.id,a={order_type_id:4,concept_id:856,start_date:this.date,observation:{concept_id:856,obs_datetime:this.date,value_numeric:this.viralLoad,value_text:this.modifier}},n={order_type_id:4,concept_id:856,start_date:this.date,patient_id:e},t.next=5,pt["a"].createEncounter(e,13);case 5:if(r=t.sent,201!==r.status&&200!==r.status){t.next=24;break}return i=r.encounter_id,n.encounter_id=i,t.next=11,d["a"].post("orders",n);case 11:if(s=t.sent,201!==s.status&&200!==s.status){t.next=19;break}return t.next=15,d["a"].post("observations",{encounter_id:i,observations:[a.observation]});case 15:o=t.sent,201===o.status||200===o.status?(this.posting=!1,p["a"].$emit("reload-visits",""),this.$toasted.show("Viral Load Saved",{theme:"toasted-primary",position:"top-right",duration:2e3}),this.$root.$emit("bv::hide::modal","viral-load-modal","#btnShow")):(this.success=!1,this.fail=!0,this.postResponse="Appointment could not be set."),t.next=22;break;case 19:this.success=!1,this.fail=!0,this.postResponse="Appointment could not be set.";case 22:t.next=27;break;case 24:this.success=!1,this.fail=!0,this.postResponse="Appointment could not be set.";case 27:console.log(a);case 28:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},Tt=Dt,Et=Object(g["a"])(Tt,kt,Ot,!1,null,null,null),$t=Et.exports,Rt={name:"home",components:{"top-nav":i["a"],"side-bar":s["a"],"patient-information":y,"visit-data":T,"clinic-registration":E["a"],encounter:ft,outcome:Nt,"viral-load":$t},data:function(){return{date:h()().format("YYYY-MM-DD")}}},St=Rt,Pt=(a("29bc"),Object(g["a"])(St,n,r,!1,null,null,null));e["default"]=Pt.exports},8111:function(t,e,a){},a434:function(t,e,a){"use strict";var n=a("23e7"),r=a("23cb"),i=a("a691"),s=a("50c4"),o=a("7b0b"),u=a("65f0"),c=a("8418"),l=a("1dde"),d=a("ae40"),p=l("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),v=Math.max,h=Math.min,f=9007199254740991,b="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!m},{splice:function(t,e){var a,n,l,d,p,m,g=o(this),_=s(g.length),y=r(t,_),x=arguments.length;if(0===x?a=n=0:1===x?(a=0,n=_-y):(a=x-2,n=h(v(i(e),0),_-y)),_+a-n>f)throw TypeError(b);for(l=u(g,n),d=0;d<n;d++)p=y+d,p in g&&c(l,d,g[p]);if(l.length=n,a<n){for(d=y;d<_-n;d++)p=d+n,m=d+a,p in g?g[m]=g[p]:delete g[m];for(d=_;d>_-n+a;d--)delete g[d-1]}else if(a>n)for(d=_-n;d>y;d--)p=d+n-1,m=d+a-1,p in g?g[m]=g[p]:delete g[m];for(d=0;d<a;d++)g[d+y]=arguments[d+2];return g.length=_-n+a,l}})},be43:function(t,e,a){},c8d2:function(t,e,a){var n=a("d039"),r=a("5899"),i="​᠎";t.exports=function(t){return n((function(){return!!r[t]()||i[t]()!=i||r[t].name!==t}))}},e69d:function(t,e,a){},f7e7:function(t,e,a){}}]);
//# sourceMappingURL=chunk-74ed8814.9cfb58b6.js.map