(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c850759"],{"336a":function(t,e,r){"use strict";var a=r("df61"),n=r.n(a);n.a},3835:function(t,e,r){"use strict";function a(t){if(Array.isArray(t))return t}r("a4d3"),r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("25f0"),r("3ca3"),r("ddb0");function n(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0)if(r.push(i.value),e&&r.length===e)break}catch(c){n=!0,s=c}finally{try{a||null==o["return"]||o["return"]()}finally{if(n)throw s}}return r}}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(t,e){return a(t)||n(t,e)||s()}r.d(e,"a",(function(){return i}))},"386a":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"d-flex",attrs:{id:"wrapper"}},[r("side-bar"),r("div",{attrs:{id:"page-content-wrapper"}},[r("top-nav"),r("div",{staticClass:"col-12 table-col",attrs:{id:"main-container"}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-12"},[r("span",[t._v(t._s(t.report_title)),r("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.$router.go(-1)}}},[t._v("Back")])]),r("sdPicker",{staticStyle:{"z-index":"50"},attrs:{onSubmit:t.fetchDates}})],1)]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-12"},[r("ReportOverlay",{attrs:{reportLoading:t.reportLoading}},[r("table",{staticClass:"table table-striped report",attrs:{id:"cohort-clients"}},[r("thead",[r("tr",[r("th",{attrs:{scope:"col"}}),r("th",{staticStyle:{width:"20%"},attrs:{scope:"col"}},[t._v("Age group")]),r("th",{staticStyle:{width:"20%"},attrs:{scope:"col"}},[t._v("Gender")]),r("th",{staticClass:"center-text",attrs:{scope:"col"}},[t._v("Started New on ART")]),r("th",{staticClass:"center-text",attrs:{scope:"col"}},[t._v("Started Previously on ART")]),r("th",{staticClass:"center-text",attrs:{scope:"col"}},[t._v("Completed New on ART")]),r("th",{staticClass:"center-text",attrs:{scope:"col"}},[t._v("Completed Previously on ART")])])]),r("tfoot",[r("tr",[r("td",[t._v(" Date Created: "+t._s(t.moment().format("YYYY-MM-DD:h:m:s"))+" e-Mastercard Version : "+t._s(t.EMCVersion)+" API Version "+t._s(t.APIVersion)+" ")])])])])])],1)])])],1),r("div",{staticClass:"modal fade",attrs:{id:"myModal",role:"dialog"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Ã—")]),r("h4",{staticClass:"modal-title"},[t._v(t._s(this.selectedGender)+" "+t._s(this.selectedAgeGroup))])]),t._m(0),t._m(1)])])])],1)},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-body"},[r("table",{attrs:{id:"drill-down"}},[r("tr",[r("th",[t._v("ARV number")]),r("th",[t._v("Regimen")]),r("th",[t._v("Qty")]),r("th",[t._v("Dispensed date")])])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-footer"},[r("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],s=(r("a4d3"),r("99af"),r("4de4"),r("4160"),r("b0c0"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("3835")),i=(r("96cf"),r("1da1")),o=r("ade3"),c=r("8051"),l=r("ebd8"),d=r("7c08"),u=r("c1df"),p=r.n(u),f=r("4dfe"),h=r("8e71"),v=r("2f62"),b=r("1157"),m=r.n(b);r("6810");function D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?D(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}r("2cdf"),r("fd5e"),r("5caa"),r("c3dc"),r("4e95"),r("a8a1"),r("919c"),r("4b69"),r("7dae"),r("a821");var g={name:"reports",components:{ReportOverlay:h["a"],"top-nav":l["a"],"side-bar":d["a"],sdPicker:f["a"]},computed:y({},Object(v["c"])(["location"]),{reportTitle:function(){if(this.startDate&&this.endDate){var t=function(t){return p()(t).format("dddd, Do of MMM YYYY")};return"".concat(this.location.name," TX CURR MMD between ").concat(t(this.startDate)," and ").concat(t(this.endDate)," ")}return"".concat(this.location.name," TX CURR MMD")}}),methods:{fetchDates:function(t){this.validateDateRange(t)&&(this.startDate=t[0],this.endDate=t[1],this.reportLoading=!0,this.report_title="PEPFAR "+sessionStorage.location_name+" TB PREV report ",this.report_title+=p()(t[0]).format("DDMMMYYYY"),this.report_title+=" - "+p()(t[1]).format("DDMMMYYYY"),this.initReportingGroups(),this.fetchData())},fetchData:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.reportingGroups.length>0)){t.next=6;break}e=this.setMinMaxAges(this.reportingGroups[0]),e[0],e[1],t.next=9;break;case 6:return this.reportLoading=!1,this.$nextTick(this.renderTable),t.abrupt("return");case 9:return r="tb_prev?start_date="+this.startDate+"&date="+p()().format("YYYY-MM-DD"),r+="&end_date="+this.endDate+"&program_id=1",t.next=13,c["a"].get(r,{},{});case 13:a=t.sent,200===a.status&&a.json().then((function(t){return n.addRow(t)}));case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addLink:function(t,e,r,a){console.log(t+" --- "+e);var n=document.createElement("span"),s=document.createElement("a");return s.setAttribute("href","#"),s.setAttribute("age-group",t),s.setAttribute("gender",e),s.setAttribute("column_number",a),s.setAttribute("click","showPoPBox('"+t+"');"),s.innerHTML=r,n.appendChild(s),n.innerHTML},showPoPBox:function(t){console.log(t)},initDataTable:function(t){this.dTable=m()("#cohort-clients").dataTable({order:[[0,"asc"]],fixedHeader:!0,paging:!1,dom:"Bfrtip",destroy:!0,data:t,buttons:[{extend:"copy",title:this.report_title},{extend:"csv",title:this.report_title,footer:!0},{extend:"pdf",title:this.report_title},{extend:"print",title:this.report_title}],columnDefs:[{className:"center-text",targets:3},{className:"center-text",targets:4},{className:"center-text",targets:5},{className:"center-text",targets:6}]})},initReportingGroups:function(){this.reportingGroups=["<1 year","1-4 years","5-9 years","10-14 years","15-19 years","20-24 years","25-29 years","30-34 years","35-39 years","40-44 years","45-49 years","50 plus years"],this.tableRows=[]},addRow:function(t){var e={};this.initReportingGroups();for(var r in t){var a=t[r],n=a.age_group,s=a.gender,i=a.client;a.outcome;void 0==e[n]&&(e[n]={}),void 0==e[n][s]&&(e[n][s]={new:[],old:[],art:[],defaulter:[],died:[],stopped:[],transfer_out:[],unknown:[],new_initiated:[],old_initiated:[]}),"New on ART"==i&&a.course_completed&&e[n][s].new.push(r),"Previously on ART"==i&&a.course_completed&&e[n][s].old.push(r),"New on ART"==i?e[n][s].new_initiated.push(r):e[n][s].old_initiated.push(r)}this.repData=e,this.renderResults()},renderResults:function(){var t=this,e=m()("#cohort-clients").DataTable();e.clear();var r=["copy","csv","pdf","print"];r.forEach((function(){return e.button().remove()})),r.forEach((function(r,a){e.button().add(a,{extend:r,title:t.report_title,footer:!0})}));for(var a=1,n=this.reportingGroups,s=["F","M"],i=0;i<s.length;i++)for(var o=0;o<n.length;o++){try{var c=this.repData[n[o]][s[i]]}catch(l){}void 0!=c?(e.row.add([a++,n[o],s[i],this.setDrillClients(n[o],s[i],c.new_initiated,1),this.setDrillClients(n[o],s[i],c.old_initiated,2),this.setDrillClients(n[o],s[i],c.new,3),this.setDrillClients(n[o],s[i],c.old,4)]).draw(),c=void 0):e.row.add([a++,n[o],s[i],0,0,0,0]).draw()}this.reportLoading=!1},setDrillClients:function(t,e,r,a){var n={};if(r.length<1)return 0;n[t]||(n[t]={}),n[t][e]||(n[t][e]={}),n[t][e][a]=r;return", '"+e+"','"+t+"')",r.length},setMinMaxAges:function(t){return"<1 year"==t?[0,0]:"1-4 years"==t?[1,4]:"5-9 years"==t?[5,9]:"10-14 years"==t?[10,14]:"15-19 years"==t?[15,19]:"20-24 years"==t?[20,24]:"25-29 years"==t?[25,29]:"30-34 years"==t?[30,34]:"35-39 years"==t?[35,39]:"40-44 years"==t?[40,44]:"45-49 years"==t?[45,49]:"50 plus years"==t?[50,1e4]:void 0},renderTable:function(){var t=this,e=m()("#cohort-clients").DataTable();e.clear();var r=["copy","csv","pdf","print"];r.forEach((function(){return e.button().remove()})),r.forEach((function(r,a){e.button().add(a,{extend:r,title:t.report_title,footer:!0})}));for(var a=["Female","Male"],n=1,s=this.tableRows,i=0;i<a.length;i++)for(var o=0;o<s.length;o++)a[i]==s[o][1]&&e.row.add([n++,s[o][0],s[o][1],s[o][2],s[o][3],s[o][4]]);e.draw()},validateDateRange:function(t){var e=Object(s["a"])(t,2),r=e[0],a=e[1];return r&&a&&"Invalid date"!==r&&"Invalid date"!==a?!p()(r).isAfter(a)||(this.$bvToast.toast("Start date can not be less than end date",{title:"Error",variant:"warning"}),!1):(this.$bvToast.toast("Please select a start date and an end date",{title:"Error",variant:"warning"}),!1)}},mounted:function(){var t=this;this.$nextTick((function(){t.initReportingGroups(),t.initDataTable()}))},data:function(){return{report_title:"TB PREV. ",reportData:null,dTable:null,startDate:null,endDate:null,rowCounter:1,column_3:{},column_4:{},column_5:{},tableRows:[],selectedAgeGroup:null,selectedGender:null,reportingGroups:[],reportLoading:!1,APIVersion:sessionStorage.APIVersion,EMCVersion:sessionStorage.EMCVersion,repData:{}}}},_=g,w=(r("bfa9d"),r("6f55"),r("2877")),C=Object(w["a"])(_,a,n,!1,null,"32c031fb",null);e["default"]=C.exports},"4dfe":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ctrs"},[r("div",{staticClass:"ctr-table"},[r("div",{staticClass:"ctr-row"},[r("div",{staticClass:"ctr-cell"},[r("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"Start Date",readonly:!0}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),r("div",{staticClass:"ctr-cell"},[r("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"End Date",readonly:!0}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),r("div",{staticClass:"ctr-cell"},[r("button",{staticClass:"btn btn-success",on:{click:t.submitDates}},[t._v("Submit")])])])])])},n=[],s=r("f0ca"),i=r.n(s),o=r("c1df"),c=r.n(o),l=(r("6f3c"),r("1789")),d={components:{DatePick:i.a},props:["onSubmit"],data:function(){return{startDate:null,endDate:null,format:"DD/MMM/YYYY",date:l["a"].format(new Date,"DD/MMM/YYYY")}},methods:{initDates:function(){},submitDates:function(){this.startDate=c()(this.startDate).format("YYYY-MM-DD"),this.endDate=c()(this.endDate).format("YYYY-MM-DD"),this.onSubmit([this.startDate,this.endDate])},parseDate:function(t,e){return l["a"].parse(t,e)},formatDate:function(t,e){return l["a"].format(t,e)}},mounted:function(){var t=this;setTimeout((function(){return t.initDates()}),300)}},u=d,p=(r("336a"),r("2877")),f=Object(p["a"])(u,a,n,!1,null,"15deca72",null);e["a"]=f.exports},"6d1a":function(t,e,r){},"6f55":function(t,e,r){"use strict";var a=r("ff59"),n=r.n(a);n.a},"8e71":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-overlay",{attrs:{show:t.hideReport,"no-center":!0,"spinner-type":"grow","spinner-variant":"primary"},scopedSlots:t._u([{key:"overlay",fn:function(){return[r("div",{staticStyle:{display:"block","min-height":"720px",width:"100%","padding-top":"20%"}},[t.reportSelected?t._e():r("h1",[t._v("No Report Selected")]),t.reportSelected?r("b-spinner",{attrs:{type:"grow",variant:"primary"}}):t._e()],1)]},proxy:!0}])},[t._t("default")],2)},n=[],s={name:"report-overlay",props:{reportLoading:{type:Boolean,required:!0},reportSelected:{type:Boolean,default:!0}},computed:{hideReport:function(){return this.reportLoading||!this.reportSelected}}},i=s,o=r("2877"),c=Object(o["a"])(i,a,n,!1,null,null,null);e["a"]=c.exports},bfa9d:function(t,e,r){"use strict";var a=r("6d1a"),n=r.n(a);n.a},df61:function(t,e,r){},ff59:function(t,e,r){}}]);
//# sourceMappingURL=chunk-5c850759.996ad9a6.js.map